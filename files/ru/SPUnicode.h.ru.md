Title: SPUnicode.h


# STAPPLER_CORE_STRING_SPUNICODE_H_

## BRIEF

Заголовок базовых функций поддержки юникода

## CONTENT

Заголовок базовых функций поддержки юникода

Фреймворк использует кодирование в UTF-8 для 8-битных строк и UTF-16 для 16-битных. Отдельные символы обрабатываются как char32_t.

# ::stappler::unicode::utf8_length_data

## BRIEF

Таблица поиска для длины кодированного символа в UTF-8

## CONTENT

Таблица поиска для длины кодированного символа в UTF-8. По первому символу кода определяет число символов для полного символа юникода.

Тип: uint8_t const[256]


# ::stappler::unicode::utf16_length_data

## BRIEF

Таблица поиска для длины кодированного символа в UTF-16 для символа UTF-8

## CONTENT

Таблица поиска для длины кодированного символа в UTF-16 для символа UTF-8. Используется при прямом транскодировании.

Тип: uint8_t const[256]


# ::stappler::unicode::utf8_length_mask

## BRIEF

Таблица для поиска значимой маски для символа UTF-8

## CONTENT

Таблица для поиска значимой маски для символа UTF-8. Маска позволяет оставить только значимые символы в первом символе кода.

Тип: uint8_t const[256]


# ::stappler::unicode::isUtf8Surrogate(char)

## BRIEF

Проверяет, является ли символ юникода суррогатным

## CONTENT

Проверяет, является ли символ юникода суррогатным (то есть, частью большего кода)

Параметры:
* char

Возвращает:
* bool

# ::stappler::unicode::utf8Decode32(char const*)

## BRIEF

Декодирует символ юникода из UTF-8

## CONTENT

Декодирует символ юникода из UTF-8

Параметры:
* char const*

Возвращает:
* char32_t

# ::stappler::unicode::utf8Decode32(char const*,uint8_t&)

## BRIEF

Декодирует символ юникода из UTF-8

## CONTENT

Декодирует символ юникода из UTF-8

Параметры:
* char const*
* uint8_t& - возвращает число прочитанных байт

Возвращает:
* char32_t

# ::stappler::unicode::utf8EncodeLength(char16_t)

## BRIEF

Вычисляет размер кодирования символа в UTF-8 в байтах

## CONTENT

Вычисляет размер кодирования символа в UTF-8 в байтах

Параметры:
* char16_t

Возвращает:
* uint8_t

# ::stappler::unicode::utf8EncodeLength(char32_t)

## BRIEF

Вычисляет размер кодирования символа в UTF-8 в байтах

## CONTENT

Вычисляет размер кодирования символа в UTF-8 в байтах

Параметры:
* char32_t

Возвращает:
* uint8_t

# ::stappler::unicode::utf8EncodeBuf(char*,char16_t)

## BRIEF

Кодирует символ в UTF-8, записывает в буфер

## CONTENT

Кодирует символ в UTF-8, записывает в буфер

Параметры:
* char* - буфер для кодирования
* char16_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8EncodeBuf(char*,char32_t)

## BRIEF

Кодирует символ в UTF-8, записывает в буфер

## CONTENT

Кодирует символ в UTF-8, записывает в буфер

Параметры:
* char* - буфер для кодирования
* char32_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(std::string&,char16_t)

## BRIEF

Кодирует символ в UTF-8, записывает в строку

## CONTENT

Кодирует символ в UTF-8, записывает в строку

Параметры:
* std::string&
* char16_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(std::string&,char32_t)

## BRIEF

Кодирует символ в UTF-8, записывает в строку

## CONTENT

Кодирует символ в UTF-8, записывает в строку

Параметры:
* std::string&
* char32_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(memory::string&,char16_t)

## BRIEF

Кодирует символ в UTF-8, записывает в строку

## CONTENT

Кодирует символ в UTF-8, записывает в строку

Параметры:
* memory::string&
* char16_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(memory::string&,char32_t)

## BRIEF

Кодирует символ в UTF-8, записывает в строку

## CONTENT

Кодирует символ в UTF-8, записывает в строку

Параметры:
* memory::string&
* char32_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(std::ostream&,char16_t)

## BRIEF

Кодирует символ в UTF-8, записывает в поток

## CONTENT

Кодирует символ в UTF-8, записывает в поток

Параметры:
* std::ostream&
* char16_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf8Encode(std::ostream&,char32_t)

## BRIEF

Кодирует символ в UTF-8, записывает в поток

## CONTENT

Кодирует символ в UTF-8, записывает в поток

Параметры:
* std::ostream&
* char32_t

Возвращает:
* uint8_t - число записанных байт

# ::stappler::unicode::utf16EncodeLength(char32_t)

## BRIEF

Возвращает длину символа при кодировании UTF-16

## CONTENT

Возвращает длину символа при кодировании UTF-16

Параметры:
* char32_t

Возвращает:
* uint8_t - 1 или 2 байта

# ::stappler::unicode::utf16EncodeBuf(char16_t*,char32_t)

## BRIEF

Кодирует символ в UTF-16, записывает в буфер

## CONTENT

Кодирует символ в UTF-16, записывает в буфер

Параметры:
* char16_t*
* char32_t

Возвращает:
* uint8_t - число записанных 16-битных символов

# ::stappler::unicode::utf16Encode(std::u16string&,char32_t)

## BRIEF

Кодирует символ в UTF-16, записывает в строку

## CONTENT

Кодирует символ в UTF-16, записывает в строку

Параметры:
* std::u16string&
* char32_t

Возвращает:
* uint8_t - число записанных 16-битных символов

# ::stappler::unicode::utf16Encode(memory::u16string&,char32_t)

## BRIEF

Кодирует символ в UTF-16, записывает в строку

## CONTENT

Кодирует символ в UTF-16, записывает в строку

Параметры:
* memory::u16string&
* char32_t

Возвращает:
* uint8_t - число записанных 16-битных символов


# ::stappler::string::DOUBLE_MAX_DIGITS

## BRIEF

Максимальное число символов, используемых в алгоритме _dtoa

## CONTENT

Максимальное число символов, используемых в алгоритме _dtoa

Тип: size_t const


# ::stappler::string::_itoa(int64_t,char*,size_t)

## BRIEF

Записывает целое число в строковый буфер

## CONTENT

Записывает целое число в строковый буфер. Алгоритм записывает число в буфер, начиная с конца буфера. Таким образом, первый символ числа будет записан по адресу buf + bsize - ret, где ret - значение возврата.

Параметры:
* int64_t - исходное число
* char* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::string::_itoa(uint64_t,char*,size_t)

## BRIEF

Записывает целое число в строковый буфер

## CONTENT

Записывает целое число в строковый буфер. Алгоритм записывает число в буфер, начиная с конца буфера. Таким образом, первый символ числа будет записан по адресу buf + bsize - ret, где ret - значение возврата.

Параметры:
* uint64_t - исходное число
* char* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::string::_itoa(int64_t,char16_t*,size_t)

## BRIEF

Записывает целое число в строковый буфер

## CONTENT

Записывает целое число в строковый буфер. Алгоритм записывает число в буфер, начиная с конца буфера. Таким образом, первый символ числа будет записан по адресу buf + bsize - ret, где ret - значение возврата.

Параметры:
* int64_t - исходное число
* char16_t* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::string::_itoa(uint64_t,char16_t*,size_t)

## BRIEF

Записывает целое число в строковый буфер

## CONTENT

Записывает целое число в строковый буфер. Алгоритм записывает число в буфер, начиная с конца буфера. Таким образом, первый символ числа будет записан по адресу buf + bsize - ret, где ret - значение возврата.

Параметры:
* uint64_t - исходное число
* char16_t* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::string::_dtoa(double,char*,size_t)

## BRIEF

Записывает число с плавающей точкой в строку по алгоритму Grisu2.

## CONTENT

Записывает число с плавающей точкой в строку по алгоритму Grisu2. Буфер должен быть не меньше `DOUBLE_MAX_DIGITS`. Запись идёт с начала буфера.

Параметры:
* double - исходное число
* char* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::string::_dtoa(double,char16_t*,size_t)

## BRIEF

Записывает число с плавающей точкой в строку по алгоритму Grisu2.

## CONTENT

Записывает число с плавающей точкой в строку по алгоритму Grisu2. Буфер должен быть не меньше `DOUBLE_MAX_DIGITS`. Запись идёт с начала буфера.

Параметры:
* double - исходное число
* char16_t* - указатель на начало буфера
* size_t - размер буфера

Возвращает:
* size_t - число аписанных символов

# ::stappler::unicode::utf8HtmlDecode32(char const*,uint8_t&)

## BRIEF

Декодирует символ юникода из UTF-8 строки

## CONTENT

Декодирует символ юникода из UTF-8 строки

Параметры:
* char const* - исходная строка
* uint8_t& - (вывод) - длина символа в строке в байтах

Возвращает:
* char32_t - прочитанный символ

# ::stappler::unicode::utf8EncodeCb<typename>(PutCharFn const&,char16_t)

## BRIEF

Кодирует символ юникода в UTF-8 с помощью функтора

## CONTENT

Кодирует символ юникода в UTF-8 с помощью функтора. Функтор вызывается с символом типа char.

Параметры шаблона:
* typename PutCharFn

Параметры:
* PutCharFn const& - функтор
* char16_t - символ для кодирования

Возвращает:
* uint8_t - число записанных символов

# ::stappler::unicode::utf8EncodeCb<typename>(PutCharFn const&,char32_t)

## BRIEF

Кодирует символ юникода в UTF-8 с помощью функтора

## CONTENT

Кодирует символ юникода в UTF-8 с помощью функтора. Функтор вызывается с символом типа char.

Параметры шаблона:
* typename PutCharFn

Параметры:
* PutCharFn const& - функтор
* char32_t - символ для кодирования

Возвращает:
* uint8_t - число записанных символов

# ::stappler::unicode::utf16Decode32(char16_t const*,uint8_t&)

## BRIEF

Читает символ юникода из UTF-16

## CONTENT

Читает символ юникода из UTF-16

Параметры:
* char16_t const* - исходная строка
* uint8_t& - (вывод) число прочитанных 16-битных символов

Возвращает:
* char32_t

# ::stappler::unicode::utf16Decode32(char16_t const*)

## BRIEF

Читает символ юникода из UTF-16

## CONTENT

Читает символ юникода из UTF-16

Параметры:
* char16_t const*

Возвращает:
* char32_t

# ::stappler::unicode::utf16EncodeCb<typename>(PutCharFn const&,char32_t)

## BRIEF

Кодирует символ юникода в UTF-16 с помощью функтора

## CONTENT

Кодирует символ юникода в UTF-16 с помощью функтора. Функтор вызывается с символом типа char16_t.

Параметры шаблона:
* typename PutCharFn

Параметры:
* PutCharFn const&
* char32_t

Возвращает:
* uint8_t - число кодированных символов

# ::stappler::unicode::utf16Encode<typename std::enable_if<std::is_class<std::ctype<char16_t>>::value>::type*>(std::basic_ostream<char16_t>&,char32_t)

## BRIEF

Кодирует символ юникода в UTF-16 и выводит в поток

## CONTENT

Кодирует символ юникода в UTF-16 и выводит в поток

Параметры шаблона:
* typename std::enable_if<std::is_class<std::ctype<char16_t>>::value>::type* - проверка на доступность потока с 16-битными символами

Параметры:
* std::basic_ostream<char16_t>&
* char32_t

# ::stappler::platform::tolower(char32_t)

## BRIEF

Конвертирует символ в нижний регистр по правилам юникода

## CONTENT

Конвертирует символ в нижний регистр по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t

# ::stappler::platform::toupper(char32_t)

## BRIEF

Конвертирует символ в верхний регистр по правилам юникода

## CONTENT

Конвертирует символ в верхний регистр по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t

# ::stappler::platform::totitle(char32_t)

## BRIEF

Конвертирует символ в верхний регистр для заглавных букв по правилам юникода

## CONTENT

Конвертирует символ в верхний регистр для заглавных букв по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t


# ::stappler::string::tolower(char32_t)

## BRIEF

Конвертирует символ в нижний регистр по правилам юникода

## CONTENT

Конвертирует символ в нижний регистр по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t

# ::stappler::string::toupper(char32_t)

## BRIEF

Конвертирует символ в верхний регистр по правилам юникода

## CONTENT

Конвертирует символ в верхний регистр по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t

# ::stappler::string::totitle(char32_t)

## BRIEF

Конвертирует символ в верхний регистр для заглавных букв по правилам юникода

## CONTENT

Конвертирует символ в верхний регистр для заглавных букв по правилам юникода. Использует функции платформы.

Параметры:
* char32_t

Возвращает:
* char32_t

# ::stappler::string::_itoa_len(int64_t)

## BRIEF

Возвращает длину кодирования числа в строку

## CONTENT

Возвращает длину кодирования числа в строку

Параметры:
* int64_t - исходное число

Возвращает:
* size_t - требуемая длина строки


# ::stappler::string::_itoa_len(uint64_t)

## BRIEF

Возвращает длину кодирования числа в строку

## CONTENT

Возвращает длину кодирования числа в строку

Параметры:
* int64_t - исходное число

Возвращает:
* size_t - требуемая длина строки

# ::stappler::string::_dtoa_len(double)

## BRIEF

Возвращает длину кодирования числа в строку

## CONTENT

Возвращает длину кодирования числа в строку

Параметры:
* double - исходное число

Возвращает:
* size_t - требуемая длина строки

# ::stappler::string::readNumber<typename,typename>(Char const*,size_t,int,uint8_t&)

## BRIEF

Читает число из строки

## CONTENT

Читает число из строки (как `strtoi`, `strtod`). Функция защищена от чтения за пределами буфера.

Параметры шаблона:
* typename T - тип числа
* typename Char - тип символа

Параметры:
* Char const* - буфер для чтрения
* size_t - длина буфера
* int - размерность числа для целых чисел
* uint8_t& - (вывод) - число прочитанных символов из строки

Возвращает:
* Result<T> - прочитанное число или пустой результат

Title: Административный интерфейс

# Административный интерфейс

Модуль предоставляет административный интерфейс, определённый на странице `<hostname>/__server`.

## Настройка

Для настройки интерфейса при первом входе необходимо ввести имя основного пользователя и его пароль. После этого параметры этого пользователя будут использоваться для входа в интерфейс через `Basic` авторизацию.

## Стандартная авторизация

Сервер предоставляет авторизацию для администраторов сервера, которая создаёт сессию, с помощью которой можно обращаться к другим страницам в качестве администратора.

`GET /__server/auth/login` - авторизация пользователя

Запрос:
* name - Имя пользователя
* passwd - Пароль
* maxAge - Время сеанса в секундах (максимум - 720 секунд)

Ответ:
* token - идентификатор сеанса, этот идентификатор необходимо отправлять в строке запроса для авторизации
* maxAge - длительность сеанса
* userId - ID пользователя

`GET /__server/auth/update` - продлевает период авторизации

Запрос:
* maxAge - Время сеанса в секундах (максимум - 720 секунд)

Ответ:
* token - идентификатор сеанса, этот идентификатор необходимо отправлять в строке запроса для авторизации
* maxAge - длительность сеанса
* userId - ID пользователя

`GET /__server/auth/cancel` - завершает текущий сеанс


*Внимание: клиентская авторизация не нужна, если активна базовая авторизация из __server. Для того, чтобы сервер перестал считать вас администратором, авторизацию в __server нужно отменить.*

## Консоль администратора

Консоль доступна с базовой страницы `/__server`. Она реализована как WebSocket. Консоль предназначена в первую очередь для ручного управления данными. Данные принимаются в формате JSON, Serenity Query и urlencoded ключ-значение.

Доступные команды:
* meta all|<name> - возвращает доступные схемы данных и информацию о конкретной схеме
* handlers  - возвращает зарегистрированные обработчики запросов
* history <scheme> <time> - получает историю изменения для схемы данных
* delta <scheme> <time> [<field> <tag>] - возвращает текущее значение дельты для схемы или выполняет дельта-запрос
* get <scheme> <path> <resolve> - получает данные из схемы, способ запроса описан в автоматических ресурсах
* create <scheme> <path> <data> - создаёт новый объект в схеме
* update <scheme> <path> <data> - модифицирует объект в схеме
* append <scheme> <path> <data> - добавляет значение к объекту
* upload <scheme> <path> - загружает файл для файлового поля (форма загруки будет выведена в консоль)
* delete <scheme> <path> - удаляет объект
* search <scheme> <path> <text> - выполняет полнотекстовый поиск
* exit  - закрывает соединение со стороны сервера
* echo <message> - проверяет соединение отправкой сообщения, которое должно вернуться
* parse <message> - распознает сообщение как тело объекта (для подтверждения верной интерпретации формата)
* help <>|<cmd> - возвращает помощь по командам
* generate_password  - создаёт пароль
* kill  - уничтожает текущий роцесс сервера с ошибкой (для отладки систем восстановления)
* time  - возвращает серверное время или конвертирует заданное время в серверное

## Другие функции

Страница `/__server/handlers` показывает текущую карту обработчиков. Чтобы карта была информативной, используйте `RequestHandlerMap`.

Страница `/__server/reports` показывает отчёты об обновлении БД и отчёты о падении сервера.

Страница `/__server/errors` показывает информацию об ошибках сервера и дополнительные данные запроса, который к ним привёл. Данные хранятся два месяца.
